"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var container=document.querySelector(".bookmarks__container"),form=document.querySelector(".bookmarks__form"),input=document.querySelector(".bookmark__input"),addButton=document.querySelector(".bookmark-add__button"),urlListWrap=document.querySelector(".bookmarks__list"),removeBtn=document.querySelector(".bookmark-remove__button"),LOCALSTORAGE=function(e){if(e){return{isActive:"localStorage"in e,get:function(e){try{var t=localStorage.getItem(e);return console.log("парс дата",JSON.parse(t)),console.log("Тип LSData: ".concat(_typeof(JSON.parse(t)))),null===t&&_typeof(JSON.parse(t))!=object?void 0:JSON.parse(t)}catch(e){console.error("Get state error: ",e)}},set:function(e,t){try{var r=JSON.stringify(t);localStorage.setItem(e,r)}catch(e){console.error("Set state error: ",e)}}}}}(window);function handleOnDomcreated(){var e=LOCALSTORAGE.get("urlList")?LOCALSTORAGE.get("urlList"):[];updateLocalStorage(e),createMarkup(e)}function updateLocalStorage(e){LOCALSTORAGE.set("urlList",e)}function checkForPrevSaved(t){var e=LOCALSTORAGE.get("urlList");return(e?e.map(function(e){return e.name}):[]).some(function(e){return e===t})}function checkForValidUrlSyntax(e){return/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/.test(e)}function handleAddBookmark(e){e.preventDefault();var t=e.target,r=LOCALSTORAGE.get("urlList");if("Add"===t.textContent){var o=r.reverse(),n={name:""};if(!checkForValidUrlSyntax(input.value))return alert("Error! You entered not valid URL"),form.reset(),void(input.value="");checkForPrevSaved(input.value)?(alert("This URL has been already saved!"),form.reset(),input.value=""):(n.name=input.value,o.push(n),createMarkup(r.reverse()),updateLocalStorage(o),form.reset())}}function createMarkup(e){urlListWrap.innerHTML="";var t=document.querySelector("#bookmark__template").innerHTML.trim(),r=Handlebars.compile(t),o=e.reduce(function(e,t){return e+r(t)},"");urlListWrap.insertAdjacentHTML("beforeend",o)}function handleRemoveBookmark(e){e.preventDefault();var t=e.target;if("x"===t.textContent){var r=t.parentNode,o=t.previousElementSibling.textContent,n=LOCALSTORAGE.get("urlList").filter(function(e){return e.name!=o});localStorage.removeItem("urlList"),updateLocalStorage(n),r.remove(),form.reset()}}form.addEventListener("click",handleAddBookmark),container.addEventListener("click",handleRemoveBookmark),document.addEventListener("DOMContentLoaded",handleOnDomcreated);